use_module(library(clpfd)).
:- discontiguous(ispointer/3).
:- discontiguous(isint/3).
:- discontiguous(isstring/3).

:- discontiguous(islong/3).

ispointer(0x3810500,0,0).
ispointer(0x3810500,8,0).
ispointer(0x3810500,16,58720256).
ispointer(0x3810500,32,0).
ispointer(0x3810500,40,0).
ispointer(0x3810500,56,0).
ispointer(0x3810500,64,0).
ispointer(0x3810500,72,0).
ispointer(0x3810500,104,54691680).
ispointer(0x3810500,112,0).
ispointer(0x3810500,120,0).
ispointer(0x3810500,144,0).
ispointer(0x3810500,152,0).
ispointer(0x3810500,160,0).
ispointer(0x3810500,168,58787240).
ispointer(0x3810500,176,58787240).
ispointer(0x3810500,184,0).
ispointer(0x3810500,200,0).
ispointer(0x3810500,208,0).
ispointer(0x3810500,216,0).
ispointer(0x3810500,224,0).
ispointer(0x3810500,232,0).
ispointer(0x3810500,240,0).
ispointer(0x3810500,248,0).
ispointer(0x3810500,256,0).
ispointer(0x3810500,264,0).
ispointer(0x3810500,272,0).
ispointer(0x3810500,280,0).
ispointer(0x3810500,288,0).
ispointer(0x3810500,296,0).
ispointer(0x3810500,304,0).
ispointer(0x3810500,312,0).
ispointer(0x3810500,320,0).
ispointer(0x3810500,328,0).
ispointer(0x3810500,336,0).
ispointer(0x3810500,344,0).
ispointer(0x3810500,352,0).
ispointer(0x3810500,360,0).
ispointer(0x3810500,368,0).
ispointer(0x3810500,376,0).
ispointer(0x3810500,384,0).
ispointer(0x3810500,392,0).
ispointer(0x3810500,400,0).
ispointer(0x3810500,408,0).
ispointer(0x3810500,416,0).
ispointer(0x3810500,424,0).
ispointer(0x3810500,432,0).
ispointer(0x3810500,440,0).
ispointer(0x3810500,448,0).
ispointer(0x3810500,456,0).
ispointer(0x3810500,464,532780072).
ispointer(0x3810500,472,0).
ispointer(0x3810500,480,0).
ispointer(0x3810500,488,0).
ispointer(0x3810500,496,0).
ispointer(0x3810500,504,0).
ispointer(0x3810500,512,0).
ispointer(0x3810500,520,0).
ispointer(0x3810500,528,0).
ispointer(0x3810500,536,0).
ispointer(0x3810500,544,0).
ispointer(0x3810500,552,0).
ispointer(0x3810500,560,0).
ispointer(0x3810500,568,0).
ispointer(0x3810500,576,58787648).
ispointer(0x3810500,584,58787648).
ispointer(0x3810500,592,0).
ispointer(0x3810500,600,0).
ispointer(0x3810500,616,0).
ispointer(0x3810500,624,63194880).
ispointer(0x3810500,632,58787704).
ispointer(0x3810500,640,0).
ispointer(0x3810500,648,0).
ispointer(0x3810500,656,0).
ispointer(0x3810500,664,0).
ispointer(0x3810500,672,0).
ispointer(0x3810500,680,0).
ispointer(0x3810500,688,0).
ispointer(0x3810500,696,0).
ispointer(0x3810500,704,0).
ispointer(0x3810500,712,0).
ispointer(0x3810500,720,58787792).
ispointer(0x3810500,728,0).
ispointer(0x3810500,736,0).
ispointer(0x3810500,744,0).
ispointer(0x3810500,752,0).
ispointer(0x3810500,760,44875792).
ispointer(0x3810500,768,532750976).
ispointer(0x3810500,784,0).
ispointer(0x3810500,792,0).
ispointer(0x3810500,800,0).
ispointer(0x3810500,808,0).
ispointer(0x3810500,816,0).
ispointer(0x3810500,1856,0).
ispointer(0x3810500,1864,0).
ispointer(0x3810500,1872,58788944).
ispointer(0x3810500,1880,58788944).
ispointer(0x3810500,1896,0).
ispointer(0x3810500,1904,0).
ispointer(0x3810500,1912,0).
ispointer(0x3810500,1920,0).
ispointer(0x3810500,1928,467322696).
ispointer(0x3810500,1936,418716872).
ispointer(0x3810500,1952,58789024).
ispointer(0x3810500,1960,58789024).
ispointer(0x3810500,1968,58789040).
ispointer(0x3810500,1976,58789040).
ispointer(0x3810500,1984,0).
ispointer(0x3810500,1992,0).
ispointer(0x3810500,2000,0).
ispointer(0x3810500,2008,0).
ispointer(0x3810500,2016,376393600).
ispointer(0x3810500,2024,0).
ispointer(0x3810500,2032,0).
ispointer(0x3810500,2040,0).
ispointer(0x3810500,2048,0).
ispointer(0x3810500,2056,0).
ispointer(0x3810500,2064,0).
ispointer(0x3810500,2072,0).
ispointer(0x3810500,2080,0).
ispointer(0x3810500,2088,0).
ispointer(0x3810500,2096,0).
ispointer(0x3810500,2104,0).
ispointer(0x3810500,2112,0).
ispointer(0x3810500,2120,0).
ispointer(0x3810500,2128,0).
ispointer(0x3810500,2136,44665792).
ispointer(0x3810500,2144,0).
ispointer(0x3810500,2152,0).
ispointer(0x3810500,2160,0).
ispointer(0x3810500,2168,0).
ispointer(0x3810500,2176,0).
ispointer(0x3810500,2184,0).
ispointer(0x3810500,2200,58787072).
ispointer(0x3810500,2208,58787072).
ispointer(0x3810500,2216,467323000).
ispointer(0x3810500,2224,467317560).
ispointer(0x3810500,2232,58789304).
ispointer(0x3810500,2240,58789304).
ispointer(0x3810500,2248,58787072).
ispointer(0x3810500,2256,58789328).
ispointer(0x3810500,2264,58789328).
ispointer(0x3810500,2272,58789344).
ispointer(0x3810500,2280,58789344).
ispointer(0x3810500,2288,0).
ispointer(0x3810500,2296,0).
ispointer(0x3810500,2304,59077760).
ispointer(0x3810500,2312,0).
ispointer(0x3810500,2320,0).
ispointer(0x3810500,2328,59077760).
ispointer(0x3810500,2336,0).
ispointer(0x3810500,2344,0).
ispointer(0x3810500,2352,59077760).
ispointer(0x3810500,2360,58789432).
ispointer(0x3810500,2368,58789432).
ispointer(0x3810500,2376,58798224).
ispointer(0x3810500,2384,58798224).
ispointer(0x3810500,2392,0).
ispointer(0x3810500,2400,0).
ispointer(0x3810500,2408,0).
ispointer(0x3810500,2416,0).
ispointer(0x3810500,2432,0).
ispointer(0x3810500,2440,0).
ispointer(0x3810500,2448,0).
ispointer(0x3810500,2456,0).
ispointer(0x3810500,2464,0).
ispointer(0x3810500,2480,0).
ispointer(0x3810500,2488,0).
ispointer(0x3810500,2496,0).
ispointer(0x3810500,2504,0).
ispointer(0x3810500,2512,0).
ispointer(0x3810500,2520,0).
ispointer(0x3810500,2528,0).
ispointer(0x3810500,2536,58789608).
ispointer(0x3810500,2544,58789608).
ispointer(0x3810500,2552,58789624).
ispointer(0x3810500,2560,58789624).
ispointer(0x3810500,2568,58789640).
ispointer(0x3810500,2576,58789640).
ispointer(0x3810500,2584,0).
ispointer(0x3810500,2592,59079104).
ispointer(0x3810500,2600,59079104).
ispointer(0x3810500,2624,0).
ispointer(0x3810500,2632,0).
ispointer(0x3810500,2640,0).
ispointer(0x3810500,2648,0).
ispointer(0x3810500,2656,0).
ispointer(0x3810500,2664,59464960).
ispointer(0x3810500,2672,59439936).
ispointer(0x3810500,2680,59078432).
ispointer(0x3810500,2688,58798208).
ispointer(0x3810500,2696,58796096).
ispointer(0x3810500,2704,0).
ispointer(0x3810500,2712,0).
ispointer(0x3810500,2720,0).
ispointer(0x3810500,2728,58789800).
ispointer(0x3810500,2736,58789800).
ispointer(0x3810500,2744,0).
ispointer(0x3810500,2752,0).
ispointer(0x3810500,2760,0).
ispointer(0x3810500,2768,0).
ispointer(0x3810500,2776,0).
ispointer(0x3810500,2784,0).
ispointer(0x3810500,2800,0).
ispointer(0x3810500,2808,0).
ispointer(0x3810500,2816,0).
ispointer(0x3810500,2824,0).
ispointer(0x3810500,2832,0).
ispointer(0x3810500,2840,0).
ispointer(0x3810500,2848,0).
ispointer(0x3810500,2856,0).
ispointer(0x3810500,2864,0).
ispointer(0x3810500,2872,0).
ispointer(0x3810500,2880,0).
ispointer(0x3810500,2888,0).
ispointer(0x3810500,2896,0).
ispointer(0x3810500,2904,0).
ispointer(0x3810500,2912,0).
ispointer(0x3810500,2920,0).
ispointer(0x3810500,2928,0).
ispointer(0x3810500,2936,0).
ispointer(0x3810500,2944,0).
ispointer(0x3810500,2952,0).
ispointer(0x3810500,2960,0).
ispointer(0x3810500,2968,0).
ispointer(0x3810500,2976,0).
ispointer(0x3810500,2984,0).
ispointer(0x3810500,2992,0).
ispointer(0x3810500,3000,0).
ispointer(0x3810500,3136,0).
ispointer(0x3810500,3144,0).
ispointer(0x3810500,3152,59283680).
ispointer(0x3810500,3160,0).
ispointer(0x3810500,3168,0).
ispointer(0x3810500,3176,0).
ispointer(0x3810500,3184,0).
ispointer(0x3810500,3192,0).
ispointer(0x3810500,3200,0).
ispointer(0x3810500,3208,0).
ispointer(0x3810500,3216,0).
ispointer(0x3810500,3224,0).
ispointer(0x3810500,3232,0).
ispointer(0x3810500,3240,0).
ispointer(0x3810500,3248,0).
ispointer(0x3810500,3256,58790328).
ispointer(0x3810500,3264,58790328).
ispointer(0x3810500,3272,58790344).
ispointer(0x3810500,3280,58790344).
ispointer(0x3810500,3288,0).
ispointer(0x3810500,3296,0).
ispointer(0x3810500,3320,0).
ispointer(0x3810500,3328,0).
ispointer(0x3810500,3336,0).
ispointer(0x3810500,3344,0).
ispointer(0x3810500,3352,58790424).
ispointer(0x3810500,3360,0).
ispointer(0x3810500,3368,0).
ispointer(0x3810500,3376,0).
ispointer(0x3810500,3384,0).
ispointer(0x3810500,3392,0).
ispointer(0x3810500,3400,0).
ispointer(0x3810500,3408,0).
ispointer(0x3810500,3416,0).
ispointer(0x3810500,3424,0).
ispointer(0x3810500,3432,0).
ispointer(0x3810500,3440,0).
ispointer(0x3810500,3448,0).
ispointer(0x3810500,3456,0).
ispointer(0x3810500,3464,0).
ispointer(0x3810500,3472,0).
ispointer(0x3810500,3480,0).
ispointer(0x3810500,3488,0).
ispointer(0x3810500,3496,0).
ispointer(0x3810500,3504,0).
ispointer(0x3810500,3512,0).
ispointer(0x3810500,3520,0).
ispointer(0x3810500,3528,0).
ispointer(0x3810500,3536,0).
ispointer(0x3810500,3544,0).
ispointer(0x3810500,3552,0).
ispointer(0x3810500,3560,0).
ispointer(0x3810500,3568,0).
ispointer(0x3810500,3576,0).
ispointer(0x3810500,3584,0).
ispointer(0x3810500,3592,0).
ispointer(0x3810500,3600,0).
ispointer(0x3810500,3608,0).
ispointer(0x3810500,3616,0).
ispointer(0x3810500,3624,0).
ispointer(0x3810500,3632,0).
ispointer(0x3810500,3640,0).
ispointer(0x3810500,3648,0).
ispointer(0x3810500,3656,0).
ispointer(0x3810500,3664,0).
ispointer(0x3810500,3672,0).
ispointer(0x3810500,3680,0).
ispointer(0x3810500,3688,0).
ispointer(0x3810500,3696,0).
ispointer(0x3810500,3704,0).
ispointer(0x3810500,3712,0).
ispointer(0x3810500,3720,0).
ispointer(0x3810500,3728,0).
ispointer(0x3810500,3736,0).
ispointer(0x3810500,3744,0).
ispointer(0x3810500,3752,0).
ispointer(0x3810500,3760,0).
ispointer(0x3810500,3768,0).
ispointer(0x3810500,3776,0).
ispointer(0x3810500,3784,0).
ispointer(0x3810500,3792,0).
ispointer(0x3810500,3800,0).
ispointer(0x3810500,3808,0).
ispointer(0x3810500,3816,0).
ispointer(0x3810500,3824,0).
ispointer(0x3810500,3832,0).
ispointer(0x3810500,3840,0).
ispointer(0x3810500,3848,0).
ispointer(0x3810500,3856,0).
ispointer(0x3810500,3864,0).
ispointer(0x3810500,3872,0).
ispointer(0x3810500,3880,0).
ispointer(0x3810500,3888,0).
ispointer(0x3810500,3896,0).
ispointer(0x3810500,3904,0).
ispointer(0x3810500,3912,0).
ispointer(0x3810500,3920,0).
ispointer(0x3810500,3928,0).
ispointer(0x3810500,3936,0).
ispointer(0x3810500,3944,0).
ispointer(0x3810500,3952,0).
ispointer(0x3810500,3960,0).
ispointer(0x3810500,3968,0).
ispointer(0x3810500,3976,0).
ispointer(0x3810500,3984,0).
ispointer(0x3810500,3992,0).
ispointer(0x3810500,4000,0).
ispointer(0x3810500,4008,0).
ispointer(0x3810500,4016,0).
ispointer(0x3810500,4024,0).
ispointer(0x3810500,4032,0).
ispointer(0x3810500,4040,0).
ispointer(0x3810500,4048,0).
ispointer(0x3810500,4056,0).
ispointer(0x3810500,4064,0).
ispointer(0x3810500,4072,0).
ispointer(0x3810500,4080,0).
ispointer(0x3810500,4088,0).
islong(0x3810500,80,4294967296).
islong(0x3810500,88,515396075640).
islong(0x3810500,128,1048576).
islong(0x3810500,136,4194304).
islong(0x3810500,192,6441419).
islong(0x3810500,1888,4294967295).
islong(0x3810500,3312,4294967295).
isint(0x3810500,0,0).
isint(0x3810500,4,0).
isint(0x3810500,8,0).
isint(0x3810500,12,0).
isint(0x3810500,24,2).
isint(0x3810500,32,0).
isint(0x3810500,36,0).
isint(0x3810500,40,0).
isint(0x3810500,44,0).
isint(0x3810500,48,1).
isint(0x3810500,52,0).
isint(0x3810500,56,0).
isint(0x3810500,60,0).
isint(0x3810500,64,0).
isint(0x3810500,68,0).
isint(0x3810500,72,0).
isint(0x3810500,76,0).
isint(0x3810500,80,0).
isint(0x3810500,84,1).
isint(0x3810500,88,120).
isint(0x3810500,92,120).
isint(0x3810500,96,120).
isint(0x3810500,100,0).
isint(0x3810500,112,0).
isint(0x3810500,116,0).
isint(0x3810500,120,0).
isint(0x3810500,124,0).
isint(0x3810500,132,0).
isint(0x3810500,140,0).
isint(0x3810500,144,0).
isint(0x3810500,148,0).
isint(0x3810500,152,0).
isint(0x3810500,156,0).
isint(0x3810500,160,0).
isint(0x3810500,164,0).
isint(0x3810500,184,0).
isint(0x3810500,188,0).
isint(0x3810500,196,0).
isint(0x3810500,200,0).
isint(0x3810500,204,0).
isint(0x3810500,208,0).
isint(0x3810500,212,0).
isint(0x3810500,216,0).
isint(0x3810500,220,0).
isint(0x3810500,224,0).
isint(0x3810500,228,0).
isint(0x3810500,232,0).
isint(0x3810500,236,0).
isint(0x3810500,240,0).
isint(0x3810500,244,0).
isint(0x3810500,248,0).
isint(0x3810500,252,0).
isint(0x3810500,256,0).
isint(0x3810500,260,0).
isint(0x3810500,264,0).
isint(0x3810500,268,0).
isint(0x3810500,272,0).
isint(0x3810500,276,0).
isint(0x3810500,280,0).
isint(0x3810500,284,0).
isint(0x3810500,288,0).
isint(0x3810500,292,0).
isint(0x3810500,296,0).
isint(0x3810500,300,0).
isint(0x3810500,304,0).
isint(0x3810500,308,0).
isint(0x3810500,312,0).
isint(0x3810500,316,0).
isint(0x3810500,320,0).
isint(0x3810500,324,0).
isint(0x3810500,328,0).
isint(0x3810500,332,0).
isint(0x3810500,336,0).
isint(0x3810500,340,0).
isint(0x3810500,344,0).
isint(0x3810500,348,0).
isint(0x3810500,352,0).
isint(0x3810500,356,0).
isint(0x3810500,360,0).
isint(0x3810500,364,0).
isint(0x3810500,368,0).
isint(0x3810500,372,0).
isint(0x3810500,376,0).
isint(0x3810500,380,0).
isint(0x3810500,384,0).
isint(0x3810500,388,0).
isint(0x3810500,392,0).
isint(0x3810500,396,0).
isint(0x3810500,400,0).
isint(0x3810500,404,0).
isint(0x3810500,408,0).
isint(0x3810500,412,0).
isint(0x3810500,416,0).
isint(0x3810500,420,0).
isint(0x3810500,424,0).
isint(0x3810500,428,0).
isint(0x3810500,432,0).
isint(0x3810500,436,0).
isint(0x3810500,440,0).
isint(0x3810500,444,0).
isint(0x3810500,448,0).
isint(0x3810500,452,0).
isint(0x3810500,456,0).
isint(0x3810500,460,0).
isint(0x3810500,472,0).
isint(0x3810500,476,0).
isint(0x3810500,480,0).
isint(0x3810500,484,0).
isint(0x3810500,488,0).
isint(0x3810500,492,0).
isint(0x3810500,496,0).
isint(0x3810500,500,0).
isint(0x3810500,504,0).
isint(0x3810500,508,0).
isint(0x3810500,512,0).
isint(0x3810500,516,0).
isint(0x3810500,520,0).
isint(0x3810500,524,0).
isint(0x3810500,528,0).
isint(0x3810500,532,0).
isint(0x3810500,536,0).
isint(0x3810500,540,0).
isint(0x3810500,544,0).
isint(0x3810500,548,0).
isint(0x3810500,552,0).
isint(0x3810500,556,0).
isint(0x3810500,560,0).
isint(0x3810500,564,0).
isint(0x3810500,568,0).
isint(0x3810500,572,0).
isint(0x3810500,592,0).
isint(0x3810500,596,0).
isint(0x3810500,600,0).
isint(0x3810500,604,0).
isint(0x3810500,608,25).
isint(0x3810500,612,0).
isint(0x3810500,616,0).
isint(0x3810500,620,0).
isint(0x3810500,640,0).
isint(0x3810500,644,0).
isint(0x3810500,648,0).
isint(0x3810500,652,0).
isint(0x3810500,656,0).
isint(0x3810500,660,0).
isint(0x3810500,664,0).
isint(0x3810500,668,0).
isint(0x3810500,672,0).
isint(0x3810500,676,0).
isint(0x3810500,680,0).
isint(0x3810500,684,0).
isint(0x3810500,688,0).
isint(0x3810500,692,0).
isint(0x3810500,696,0).
isint(0x3810500,700,0).
isint(0x3810500,704,0).
isint(0x3810500,708,0).
isint(0x3810500,712,0).
isint(0x3810500,716,0).
isint(0x3810500,728,0).
isint(0x3810500,732,0).
isint(0x3810500,736,0).
isint(0x3810500,740,0).
isint(0x3810500,744,0).
isint(0x3810500,748,0).
isint(0x3810500,752,0).
isint(0x3810500,756,0).
isint(0x3810500,776,0).
isint(0x3810500,784,0).
isint(0x3810500,788,0).
isint(0x3810500,792,0).
isint(0x3810500,796,0).
isint(0x3810500,800,0).
isint(0x3810500,804,0).
isint(0x3810500,808,0).
isint(0x3810500,812,0).
isint(0x3810500,816,0).
isint(0x3810500,820,0).
isint(0x3810500,824,1).
isint(0x3810500,828,0).
isint(0x3810500,832,1).
isint(0x3810500,836,0).
isint(0x3810500,1856,0).
isint(0x3810500,1860,0).
isint(0x3810500,1864,0).
isint(0x3810500,1868,0).
isint(0x3810500,1892,0).
isint(0x3810500,1896,0).
isint(0x3810500,1900,0).
isint(0x3810500,1904,0).
isint(0x3810500,1908,0).
isint(0x3810500,1912,0).
isint(0x3810500,1916,0).
isint(0x3810500,1920,0).
isint(0x3810500,1924,0).
isint(0x3810500,1944,140).
isint(0x3810500,1948,0).
isint(0x3810500,1984,0).
isint(0x3810500,1988,0).
isint(0x3810500,1992,0).
isint(0x3810500,1996,0).
isint(0x3810500,2000,0).
isint(0x3810500,2004,0).
isint(0x3810500,2008,0).
isint(0x3810500,2012,0).
isint(0x3810500,2024,0).
isint(0x3810500,2028,0).
isint(0x3810500,2032,0).
isint(0x3810500,2036,0).
isint(0x3810500,2040,0).
isint(0x3810500,2044,0).
isint(0x3810500,2048,0).
isint(0x3810500,2052,0).
isint(0x3810500,2056,0).
isint(0x3810500,2060,0).
isint(0x3810500,2064,0).
isint(0x3810500,2068,0).
isint(0x3810500,2072,0).
isint(0x3810500,2076,0).
isint(0x3810500,2080,0).
isint(0x3810500,2084,0).
isint(0x3810500,2088,0).
isint(0x3810500,2092,0).
isint(0x3810500,2096,0).
isint(0x3810500,2100,0).
isint(0x3810500,2104,0).
isint(0x3810500,2108,0).
isint(0x3810500,2112,0).
isint(0x3810500,2116,0).
isint(0x3810500,2120,0).
isint(0x3810500,2124,0).
isint(0x3810500,2128,0).
isint(0x3810500,2132,0).
isint(0x3810500,2144,0).
isint(0x3810500,2148,0).
isint(0x3810500,2152,0).
isint(0x3810500,2156,0).
isint(0x3810500,2160,0).
isint(0x3810500,2164,0).
isint(0x3810500,2168,0).
isint(0x3810500,2172,0).
isint(0x3810500,2176,0).
isint(0x3810500,2180,0).
isint(0x3810500,2184,0).
isint(0x3810500,2188,0).
isint(0x3810500,2288,0).
isint(0x3810500,2292,0).
isint(0x3810500,2296,0).
isint(0x3810500,2300,0).
isint(0x3810500,2312,0).
isint(0x3810500,2316,0).
isint(0x3810500,2320,0).
isint(0x3810500,2324,0).
isint(0x3810500,2336,0).
isint(0x3810500,2340,0).
isint(0x3810500,2344,0).
isint(0x3810500,2348,0).
isint(0x3810500,2392,0).
isint(0x3810500,2396,0).
isint(0x3810500,2400,0).
isint(0x3810500,2404,0).
isint(0x3810500,2408,0).
isint(0x3810500,2412,0).
isint(0x3810500,2416,0).
isint(0x3810500,2420,0).
isint(0x3810500,2424,50).
isint(0x3810500,2428,0).
isint(0x3810500,2432,0).
isint(0x3810500,2436,0).
isint(0x3810500,2440,0).
isint(0x3810500,2444,0).
isint(0x3810500,2448,0).
isint(0x3810500,2452,0).
isint(0x3810500,2456,0).
isint(0x3810500,2460,0).
isint(0x3810500,2464,0).
isint(0x3810500,2468,0).
isint(0x3810500,2472,3677).
isint(0x3810500,2476,0).
isint(0x3810500,2480,0).
isint(0x3810500,2484,0).
isint(0x3810500,2488,0).
isint(0x3810500,2492,0).
isint(0x3810500,2496,0).
isint(0x3810500,2500,0).
isint(0x3810500,2504,0).
isint(0x3810500,2508,0).
isint(0x3810500,2512,0).
isint(0x3810500,2516,0).
isint(0x3810500,2520,0).
isint(0x3810500,2524,0).
isint(0x3810500,2528,0).
isint(0x3810500,2532,0).
isint(0x3810500,2584,0).
isint(0x3810500,2588,0).
isint(0x3810500,2616,48).
isint(0x3810500,2620,0).
isint(0x3810500,2624,0).
isint(0x3810500,2628,0).
isint(0x3810500,2632,0).
isint(0x3810500,2636,0).
isint(0x3810500,2640,0).
isint(0x3810500,2644,0).
isint(0x3810500,2648,0).
isint(0x3810500,2652,0).
isint(0x3810500,2656,0).
isint(0x3810500,2660,0).
isint(0x3810500,2704,0).
isint(0x3810500,2708,0).
isint(0x3810500,2712,0).
isint(0x3810500,2716,0).
isint(0x3810500,2720,0).
isint(0x3810500,2724,0).
isint(0x3810500,2744,0).
isint(0x3810500,2748,0).
isint(0x3810500,2752,0).
isint(0x3810500,2756,0).
isint(0x3810500,2760,0).
isint(0x3810500,2764,0).
isint(0x3810500,2768,0).
isint(0x3810500,2772,0).
isint(0x3810500,2776,0).
isint(0x3810500,2780,0).
isint(0x3810500,2784,0).
isint(0x3810500,2788,0).
isint(0x3810500,2800,0).
isint(0x3810500,2804,0).
isint(0x3810500,2808,0).
isint(0x3810500,2812,0).
isint(0x3810500,2816,0).
isint(0x3810500,2820,0).
isint(0x3810500,2824,0).
isint(0x3810500,2828,0).
isint(0x3810500,2832,0).
isint(0x3810500,2836,0).
isint(0x3810500,2840,0).
isint(0x3810500,2844,0).
isint(0x3810500,2848,0).
isint(0x3810500,2852,0).
isint(0x3810500,2856,0).
isint(0x3810500,2860,0).
isint(0x3810500,2864,0).
isint(0x3810500,2868,0).
isint(0x3810500,2872,0).
isint(0x3810500,2876,0).
isint(0x3810500,2880,0).
isint(0x3810500,2884,0).
isint(0x3810500,2888,0).
isint(0x3810500,2892,0).
isint(0x3810500,2896,0).
isint(0x3810500,2900,0).
isint(0x3810500,2904,0).
isint(0x3810500,2908,0).
isint(0x3810500,2912,0).
isint(0x3810500,2916,0).
isint(0x3810500,2920,0).
isint(0x3810500,2924,0).
isint(0x3810500,2928,0).
isint(0x3810500,2932,0).
isint(0x3810500,2936,0).
isint(0x3810500,2940,0).
isint(0x3810500,2944,0).
isint(0x3810500,2948,0).
isint(0x3810500,2952,0).
isint(0x3810500,2956,0).
isint(0x3810500,2960,0).
isint(0x3810500,2964,0).
isint(0x3810500,2968,0).
isint(0x3810500,2972,0).
isint(0x3810500,2976,0).
isint(0x3810500,2980,0).
isint(0x3810500,2984,0).
isint(0x3810500,2988,0).
isint(0x3810500,2992,0).
isint(0x3810500,2996,0).
isint(0x3810500,3000,0).
isint(0x3810500,3004,0).
isint(0x3810500,3136,0).
isint(0x3810500,3140,0).
isint(0x3810500,3144,0).
isint(0x3810500,3148,0).
isint(0x3810500,3160,0).
isint(0x3810500,3164,0).
isint(0x3810500,3168,0).
isint(0x3810500,3172,0).
isint(0x3810500,3176,0).
isint(0x3810500,3180,0).
isint(0x3810500,3184,0).
isint(0x3810500,3188,0).
isint(0x3810500,3192,0).
isint(0x3810500,3196,0).
isint(0x3810500,3200,0).
isint(0x3810500,3204,0).
isint(0x3810500,3208,0).
isint(0x3810500,3212,0).
isint(0x3810500,3216,0).
isint(0x3810500,3220,0).
isint(0x3810500,3224,0).
isint(0x3810500,3228,0).
isint(0x3810500,3232,0).
isint(0x3810500,3236,0).
isint(0x3810500,3240,0).
isint(0x3810500,3244,0).
isint(0x3810500,3248,0).
isint(0x3810500,3252,0).
isint(0x3810500,3288,0).
isint(0x3810500,3292,0).
isint(0x3810500,3296,0).
isint(0x3810500,3300,0).
isint(0x3810500,3304,1000).
isint(0x3810500,3308,0).
isint(0x3810500,3316,0).
isint(0x3810500,3320,0).
isint(0x3810500,3324,0).
isint(0x3810500,3328,0).
isint(0x3810500,3332,0).
isint(0x3810500,3336,0).
isint(0x3810500,3340,0).
isint(0x3810500,3344,0).
isint(0x3810500,3348,0).
isint(0x3810500,3360,0).
isint(0x3810500,3364,0).
isint(0x3810500,3368,0).
isint(0x3810500,3372,0).
isint(0x3810500,3376,0).
isint(0x3810500,3380,0).
isint(0x3810500,3384,0).
isint(0x3810500,3388,0).
isint(0x3810500,3392,0).
isint(0x3810500,3396,0).
isint(0x3810500,3400,0).
isint(0x3810500,3404,0).
isint(0x3810500,3408,0).
isint(0x3810500,3412,0).
isint(0x3810500,3416,0).
isint(0x3810500,3420,0).
isint(0x3810500,3424,0).
isint(0x3810500,3428,0).
isint(0x3810500,3432,0).
isint(0x3810500,3436,0).
isint(0x3810500,3440,0).
isint(0x3810500,3444,0).
isint(0x3810500,3448,0).
isint(0x3810500,3452,0).
isint(0x3810500,3456,0).
isint(0x3810500,3460,0).
isint(0x3810500,3464,0).
isint(0x3810500,3468,0).
isint(0x3810500,3472,0).
isint(0x3810500,3476,0).
isint(0x3810500,3480,0).
isint(0x3810500,3484,0).
isint(0x3810500,3488,0).
isint(0x3810500,3492,0).
isint(0x3810500,3496,0).
isint(0x3810500,3500,0).
isint(0x3810500,3504,0).
isint(0x3810500,3508,0).
isint(0x3810500,3512,0).
isint(0x3810500,3516,0).
isint(0x3810500,3520,0).
isint(0x3810500,3524,0).
isint(0x3810500,3528,0).
isint(0x3810500,3532,0).
isint(0x3810500,3536,0).
isint(0x3810500,3540,0).
isint(0x3810500,3544,0).
isint(0x3810500,3548,0).
isint(0x3810500,3552,0).
isint(0x3810500,3556,0).
isint(0x3810500,3560,0).
isint(0x3810500,3564,0).
isint(0x3810500,3568,0).
isint(0x3810500,3572,0).
isint(0x3810500,3576,0).
isint(0x3810500,3580,0).
isint(0x3810500,3584,0).
isint(0x3810500,3588,0).
isint(0x3810500,3592,0).
isint(0x3810500,3596,0).
isint(0x3810500,3600,0).
isint(0x3810500,3604,0).
isint(0x3810500,3608,0).
isint(0x3810500,3612,0).
isint(0x3810500,3616,0).
isint(0x3810500,3620,0).
isint(0x3810500,3624,0).
isint(0x3810500,3628,0).
isint(0x3810500,3632,0).
isint(0x3810500,3636,0).
isint(0x3810500,3640,0).
isint(0x3810500,3644,0).
isint(0x3810500,3648,0).
isint(0x3810500,3652,0).
isint(0x3810500,3656,0).
isint(0x3810500,3660,0).
isint(0x3810500,3664,0).
isint(0x3810500,3668,0).
isint(0x3810500,3672,0).
isint(0x3810500,3676,0).
isint(0x3810500,3680,0).
isint(0x3810500,3684,0).
isint(0x3810500,3688,0).
isint(0x3810500,3692,0).
isint(0x3810500,3696,0).
isint(0x3810500,3700,0).
isint(0x3810500,3704,0).
isint(0x3810500,3708,0).
isint(0x3810500,3712,0).
isint(0x3810500,3716,0).
isint(0x3810500,3720,0).
isint(0x3810500,3724,0).
isint(0x3810500,3728,0).
isint(0x3810500,3732,0).
isint(0x3810500,3736,0).
isint(0x3810500,3740,0).
isint(0x3810500,3744,0).
isint(0x3810500,3748,0).
isint(0x3810500,3752,0).
isint(0x3810500,3756,0).
isint(0x3810500,3760,0).
isint(0x3810500,3764,0).
isint(0x3810500,3768,0).
isint(0x3810500,3772,0).
isint(0x3810500,3776,0).
isint(0x3810500,3780,0).
isint(0x3810500,3784,0).
isint(0x3810500,3788,0).
isint(0x3810500,3792,0).
isint(0x3810500,3796,0).
isint(0x3810500,3800,0).
isint(0x3810500,3804,0).
isint(0x3810500,3808,0).
isint(0x3810500,3812,0).
isint(0x3810500,3816,0).
isint(0x3810500,3820,0).
isint(0x3810500,3824,0).
isint(0x3810500,3828,0).
isint(0x3810500,3832,0).
isint(0x3810500,3836,0).
isint(0x3810500,3840,0).
isint(0x3810500,3844,0).
isint(0x3810500,3848,0).
isint(0x3810500,3852,0).
isint(0x3810500,3856,0).
isint(0x3810500,3860,0).
isint(0x3810500,3864,0).
isint(0x3810500,3868,0).
isint(0x3810500,3872,0).
isint(0x3810500,3876,0).
isint(0x3810500,3880,0).
isint(0x3810500,3884,0).
isint(0x3810500,3888,0).
isint(0x3810500,3892,0).
isint(0x3810500,3896,0).
isint(0x3810500,3900,0).
isint(0x3810500,3904,0).
isint(0x3810500,3908,0).
isint(0x3810500,3912,0).
isint(0x3810500,3916,0).
isint(0x3810500,3920,0).
isint(0x3810500,3924,0).
isint(0x3810500,3928,0).
isint(0x3810500,3932,0).
isint(0x3810500,3936,0).
isint(0x3810500,3940,0).
isint(0x3810500,3944,0).
isint(0x3810500,3948,0).
isint(0x3810500,3952,0).
isint(0x3810500,3956,0).
isint(0x3810500,3960,0).
isint(0x3810500,3964,0).
isint(0x3810500,3968,0).
isint(0x3810500,3972,0).
isint(0x3810500,3976,0).
isint(0x3810500,3980,0).
isint(0x3810500,3984,0).
isint(0x3810500,3988,0).
isint(0x3810500,3992,0).
isint(0x3810500,3996,0).
isint(0x3810500,4000,0).
isint(0x3810500,4004,0).
isint(0x3810500,4008,0).
isint(0x3810500,4012,0).
isint(0x3810500,4016,0).
isint(0x3810500,4020,0).
isint(0x3810500,4024,0).
isint(0x3810500,4028,0).
isint(0x3810500,4032,0).
isint(0x3810500,4036,0).
isint(0x3810500,4040,0).
isint(0x3810500,4044,0).
isint(0x3810500,4048,0).
isint(0x3810500,4052,0).
isint(0x3810500,4056,0).
isint(0x3810500,4060,0).
isint(0x3810500,4064,0).
isint(0x3810500,4068,0).
isint(0x3810500,4072,0).
isint(0x3810500,4076,0).
isint(0x3810500,4080,0).
isint(0x3810500,4084,0).
isint(0x3810500,4088,0).
isint(0x3810500,4092,0).
isstring(0x3810500,24,9008307356303362).
isstring(0x3810500,776,18446744069414584320).
isstring(0x3810500,2192,4089281728944166648).
isstring(0x3810500,2608,3418906600723806067).
% use_module(library(clpfd)).
:- style_check(-singleton).

isTrue([X, Y]):-
    X == 49.

isTrue([X|Tail]):-
    isTrue(Tail).

possible_anything(Base_addr) :- 
    get_time(Current),
    % void *stack 
    ispointer(Base_addr, Stack_offset, Stack_value),
    
    % sched_info sched_info 
    
    /* we need to use sched_info to help locate task */
    ispointer(Base_addr, Sched_info_offset, Sched_info_value),
    Sched_info_offset > Stack_offset,
    possible_sched_info(Sched_info_value),

    
    ispointer(Base_addr, MM_offset, MM_pointer),
    ispointer(Base_addr, MM_offset2, MM_pointer2),
    MM_offset2 is MM_offset + 8,
    possible_mm_struct(MM_pointer2),

    ispointer(Base_addr, Tasks_offset, Task_value),
    % Tasks_offset > 1888,
    Tasks_offset > Sched_info_offset,
    Tasks_offset > MM_offset2 - 100,


    isint(Base_addr, Pid_offset, Value),
    Pid_offset > MM_offset2,
    isint(Base_addr, Tgid_offset, Value2),
    Tgid_offset is Pid_offset + 4,
    Tgid_offset > Tasks_offset,

    ispointer(Base_addr, Parent_offset, Parent_value),
    Parent_offset > Tgid_offset,
    Parent_offset < Tgid_offset + 20,

    ispointer(Base_addr, Parent_offset2, Parent_value2),
    Parent_offset2 is Parent_offset + 8,

    ispointer(Base_addr, Child_offset, Child_value),
    Child_offset is Parent_offset2 + 8,

    /* task_struct *group_leader */

    ispointer(Base_addr, Group_leader_offset, Group_leader_value),
    Group_leader_offset > Child_offset,
    Group_leader_offset < Child_offset + 33,


    isstring(Base_addr, Comm_offset, Comm_value),
    Comm_offset > Child_offset,

    possible_ts(Parent_value, Comm_offset, Tasks_offset),
    possible_list_head(Task_value, Comm_offset, Tasks_offset),
    possible_ts(Parent_value2, Comm_offset, Tasks_offset),
    possible_ts(Group_leader_value, Comm_offset, Tasks_offset),


    ispointer(Base_addr, Thread_group_offset, Thread_group_value),
    Thread_group_offset > Group_leader_offset,
    /* This rule is very ad hoc */
    Thread_group_offset < Group_leader_offset + 150,
    possible_thread_group(Thread_group_value, Comm_offset, Thread_group_offset),

    ispointer(Base_addr, Cred_offset1, Cred_value1),
    Cred_offset1 > Group_leader_offset,
    Cred_offset1 < Comm_offset,
    ispointer(Base_addr, Cred_offset2, Cred_value2),
    Cred_offset2 is Cred_offset1 + 8,
    Cred_offset2 < Comm_offset,
    possible_cred(Cred_value1),




    % possible_ts(Child_value, Comm_offset),

    % This did not pass the test
    % task_struct_r(Parent_value),
    get_time(End),
    Time_past is End - Current,
    log('profile.txt', 'new answer', Current),
    log('profile.txt', 'stack', Stack_offset),
    log('profile.txt', 'Sched_info_offset', Sched_info_offset),
    log('profile.txt', 'task', Tasks_offset),
    log('profile.txt', 'mm_struct', MM_offset2),
    log('profile.txt', 'pid', Pid_offset),
    log('profile.txt', 'parent', Parent_offset),
    log('profile.txt', 'group_leader', Group_leader_offset),
    log('profile.txt', 'thread_group', Thread_group_offset),
    log('profile.txt', 'cred', Cred_offset1),
    log('profile.txt', 'comm', Comm_offset),
    log('profile.txt', 'end', Time_past).

    
/*
    print_nl('stack', Stack_offset),
    print_nl('Sched_info_offset', Sched_info_offset),
    print_nl('task', Tasks_offset),
    print_nl('mm_struct', MM_offset2),
    print_nl('pid', Pid_offset),
    print_nl('parent', Parent_offset),
    print_nl('group_leader', Group_leader_offset),
    print_nl('thread_group', Thread_group_offset),
    print_nl('cred', Cred_offset1),
    print_nl('comm', Comm_offset),
    print('----------------------------'), nl.*/


log(File_name, Name, Offset):-
    open(File_name, append, Stream),
    write(Stream, Name),
    write(Stream, ':'),
    write(Stream, Offset),
    nl(Stream),
    close(Stream).

possible_task_struct(Base_addr) :- 
    % void *stack 
    ispointer(Base_addr, Stack_offset, Stack_value),
    
    % sched_info sched_info 
    
    ispointer(Base_addr, Sched_info_offset, Sched_info_value),
    Sched_info_offset > Stack_offset,
    possible_sched_info(Sched_info_value),
    
    % list_head tasks 

    
    ispointer(Base_addr, Tasks_offset, Task_value),
    Tasks_offset > Sched_info_offset,
    possible_list_head(Task_value), 

    isint(Base_addr, Pid_offset, Value),
    isint(Base_addr, Tgid_offset, Value2),
    Tgid_offset is Pid_offset + 4,
    Tgid_offset > Tasks_offset,
    

    ispointer(Base_addr, MM_offset, MM_pointer),
    MM_offset < Tgid_offset,
    
    ispointer(Base_addr, MM_offset2, MM_pointer),
    MM_offset2 is MM_offset + 8,
    possible_mm_struct(MM_pointer),



    /*list_head_next(Task_value, List_head_offset),*/


    /* task_struct *real_parent 
       task_struct *parent
       task_struct *children
    */
    
    ispointer(Base_addr, Parent_offset, Parent_value),
    Parent_offset > Tgid_offset,
    Parent_offset < Tgid_offset + 20,

    ispointer(Base_addr, Parent_offset2, Parent_value2),
    Parent_offset2 is Parent_offset + 8,

    ispointer(Base_addr, Child_offset, Child_value),
    Child_offset is Parent_offset2 + 8,

    isstring(Base_addr, Comm_offset, Comm_value),
    Comm_offset > Child_offset,

    possible_ts(Parent_value, Comm_offset),
    % possible_ts(Parent_value2, Comm_offset),
    % possible_ts(Child_value, Comm_offset),

    % This did not pass the test
    % task_struct_r(Parent_value),

    print_nl('stack', Stack_offset),
    print_nl('task', Tasks_offset),
    print_nl('pid', Pid_offset),
    print_nl('parent', Parent_offset),
    print_nl('comm', Comm_offset),
    print_nl('mm_struct', MM_offset2),
    print('------------------------------------'), nl.


    

possible_mm_struct(Base_addr) :- 
    process_create(path('python'),
                    ['subquery.py', Base_addr, "mm_struct"],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).


possible_sched_info(Base_addr) :- 
    process_create(path('python'),
                    ['subquery.py', Base_addr, "sched_info"],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).

possible_list_head(Base_addr, Comm_offset, Tasks_offset) :- 
    process_create(path('python'),
                    ['subquery.py', Base_addr, "list_head", Comm_offset, Tasks_offset],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).


task_struct_r(Base_addr):-
    process_create(path('python'),
                    ['subquery.py', Base_addr, "task_struct"],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    isTrue(Result),
    write(X), nl.

list_head_next(Base_addr, List_head_offset) :- 
    Task_addr is Base_addr - List_head_offset,
    task_struct_r(Task_addr).


possible_fs_struct(Base_addr) :- 
    process_create(path('python'),
                    ['subquery.py', Base_addr, "fs_struct"],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).

possible_tlbflush_unmap_batch(Base_addr):- 
    process_create(path('python'),
                    ['subquery.py', Base_addr, "tlbflush_unmap_batch"],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).

possible_ts(Base_addr, Comm_offset, Tasks_offset):-
    process_create(path('python'),
                    ['subquery.py', Base_addr, "ts", Comm_offset, Tasks_offset],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).

possible_group_leader(Base_addr, Comm_offset, Tasks_offset):-
    process_create(path('python'),
                    ['subquery.py', Base_addr, "group_leader", Comm_offset, Tasks_offset],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).

possible_thread_group(Base_addr, Comm_offset, Tasks_offset):-
    process_create(path('python'),
                    ['subquery.py', Base_addr, "thread_group", Comm_offset, Tasks_offset],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).

possible_cred(Base_addr) :- 
    process_create(path('python'),
                    ['subquery.py', Base_addr, "cred"],
                    [stdout(pipe(In))]),
    read_string(In, Len, X),
    string_codes(X, Result),
    close(In),
    isTrue(Result).

print_nl(Name, Content):- 
    print(Name),
    print(':'),
    print(Content),
    nl.